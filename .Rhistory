blogdown::serve_site()
blogdown::serve_site()
d <- read.csv(file='../../static/files/data-salary-2.txt')
d
library(ggplot2)
d$KID <- as.factor(d$KID)
res_lm <- lm(Y ~ X, data=d)
coef <- as.numeric(res_lm$coefficients)
p <- ggplot(d, aes(X, Y, shape=KID))
p <- p + theme_bw(base_size=18)
p <- p + geom_abline(intercept=coef[1], slope=coef[2], size=2, alpha=0.3)
p <- p + geom_point(size=2)
p <- p + scale_shape_manual(values=c(16, 2, 4, 9))
p <- p + labs(x='X (age-23)', y='Y (10,000 Yen/year)')
p
p <- ggplot(d, aes(X, Y, shape=KID))
p <- p + theme_bw(base_size=20)
p <- p + geom_abline(intercept=coef[1], slope=coef[2], size=2, alpha=0.3)
p <- p + facet_wrap(~KID)
p <- p + geom_line(stat='smooth', method='lm', se=FALSE, size=1, color='black', linetype='31', alpha=0.8)
p <- p + geom_point(size=3)
p <- p + scale_shape_manual(values=c(16, 2, 4, 9))
p <- p + labs(x='X (age-23)', y='Y (10,000 Yen/year)')
p
library(rstan)
d <- read.csv(file='../../static/files/data-salary-2.txt')
d$KID <- as.factor(d$KID)
data <- list(N=nrow(d), X=d$X, Y=d$Y)
fit <- stan(file='stanfiles/model8-1.stan', data=data, seed=1234)
fit
library(rstanarm)
rstanarm_results = stan_glm(Y ~ X, data=d, iter=2000, warmup=1000, cores=4)
summary(rstanarm_results, probs=c(.025, .975), digits=3)
library(rstan)
d <- read.csv(file='../../static/files/data-salary-2.txt')
data <- list(N=nrow(d), X=d$X, Y=d$Y, KID = d$KID, K = 4)
fit <- stan(file='stanfiles/model8-2.stan', data=data, seed=1234)
fit
library(rstanarm)
M1_stanlmer <- stan_lmer(formula = Y ~ X  + (X | KID),
data = d,
seed = 1234)
d
M1_stanlmer <- stan_lmer(formula = Y ~ X  + (X | KID),
data = d,
seed = 1234)
library(lme4)
M1 <- lmer(formula = Y ~ X  + (X | KID),
data = d,
REML = TRUE)
summary(M1)
library(rstanarm)
M1_stanlmer <- stan_lmer(formula = Y ~ X  + (X | KID),
data = d,
seed = 1234)
install.packages(c("bibtex", "caret", "deSolve", "recipes", "RSQLite"))
blogdown::serve_site()
servr::daemon_stop(1)
Salary <- read.table("https://raw.githubusercontent.com/winterwang/RStanBook/master/chap04/input/data-salary.txt",
sep = ",", header = T)
library(ggplot2)
ggplot(Salary, aes(x = X, y = Y)) +
geom_point(shape = 1, size = 4)  + theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
axis.line = element_line(colour = "bisque4",
size = 0.2, linetype = "solid"),
axis.ticks = element_line(size = 0.7),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16, colour = "gray0"),
panel.background = element_rect(fill = "gray98")) +
scale_y_continuous(limits = c(200, 1400), breaks = c(200, 600, 1000, 1400))
res_lm <- lm(Y ~ X, data = Salary)
summary(res_lm)
# 用這個線性回歸模型來對上面模型中的參數作出預測：
X_new <- data.frame(X=23:60)
conf_95 <- predict(res_lm, X_new, interval = "confidence", level = 0.95)
pred_95 <- predict(res_lm, X_new, interval = "prediction", level = 0.95)
temp_var <- predict(res_lm, interval="prediction")
new_df <- cbind(Salary, temp_var)
ggplot(new_df, aes(x = X, y = Y)) +
geom_point(shape = 1, size = 4)  + theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
axis.line = element_line(colour = "bisque4",
size = 0.2, linetype = "solid"),
axis.ticks = element_line(size = 0.7),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16, colour = "gray0"),
panel.background = element_rect(fill = "gray98")) +
geom_smooth(method = lm, se=TRUE, size = 0.3)+
scale_y_continuous(limits = c(200, 1400), breaks = c(200, 600, 1000, 1400)) +
geom_line(aes(y=lwr), color = "red", linetype = "dashed")+
geom_line(aes(y=upr), color = "red", linetype = "dashed")
library(rstan)
data <- list(N=nrow(Salary), X=Salary$X, Y = Salary$Y)
fit <- sampling(model4_5, data, seed = 1234)
print(fit)
library(ggmcmc)
ggmcmc(ggs(fit, inc_warmup = TRUE, stan_include_auxiliar = TRUE), plot = "traceplot", dev_type_html = "png",
file = "trace.html")
knitr::include_graphics("/img/traceplot-model4-5.png")
library(bayesplot)
color_scheme_set("mix-brightblue-gray")
posterior2 <- rstan::extract(fit, inc_warmup = TRUE, permuted = FALSE)
p <- mcmc_trace(posterior2, n_warmup = 0,
facet_args = list(nrow = 2, labeller = label_parsed))
p
p <- mcmc_acf_bar(posterior2)
p
p <- mcmc_dens_overlay(posterior2, color_chains = T)
p
# library(rstan) uncomment if run for the first time
data <- list(N=nrow(Salary), X=Salary$X, Y = Salary$Y)
fit2 <- sampling(
model4_5,
data = data,
pars = c("b", "sigma"),
init = function(){
list(a = runif(1, -10, 10), b = runif(1, 0, 10), sigma = 10)
},
seed = 123,
chains = 3, iter = 1000, warmup = 200, thin = 2
)
print(fit2)
parallel::detectCores() #我的桌上型電腦有8個核可以用於平行計算
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
ms <- rstan::extract(fit)
quantile(ms$b, probs = c(0.025, 0.975))
d_mcmc <- data.frame(a = ms$a, b = ms$b, sigma = ms$sigma)
head(d_mcmc)
p1 <- ggplot(d_mcmc, aes(x = a, y = b)) +
geom_point(shape = 1, size = 4)
ggExtra::ggMarginal(
p = p1,
type = 'density',
margins = 'both',
size = 4,
colour = 'black',
fill = '#2D077A'
)
N_mcmc <- length(ms$lp__)
y50_base <- ms$a + ms$b*50
y50 <- rnorm(n = N_mcmc, mean = y50_base, sd = ms$sigma)
d_mcmc <- data.frame(a = ms$a, b = ms$b, sigma = ms$sigma, y50_base, y50)
head(d_mcmc)
# the following codes are also available from the author's page:
# https://github.com/MatsuuraKentaro/RStanBook/blob/master/chap04/fig4-8.R
# library(ggplot2)
source('commonRstan.R')
# the following codes are also available from the author's page:
# https://github.com/MatsuuraKentaro/RStanBook/blob/master/chap04/fig4-8.R
# library(ggplot2)
source('commonRstan.R')
# load('output/result-model4-5.RData')
ms <- rstan::extract(fit)
X_new <- 23:60
N_X <- length(X_new)
N_mcmc <- length(ms$lp__)
set.seed(1234)
y_base_mcmc <- as.data.frame(matrix(nrow=N_mcmc, ncol=N_X))
y_mcmc <- as.data.frame(matrix(nrow=N_mcmc, ncol=N_X))
for (i in 1:N_X) {
y_base_mcmc[,i] <- ms$a + ms$b * X_new[i]
y_mcmc[,i] <- rnorm(n=N_mcmc, mean=y_base_mcmc[,i], sd=ms$sigma)
}
customize.ggplot.axis <- function(p) {
p <- p + labs(x='X', y='Y')
p <- p + scale_y_continuous(breaks=seq(from=200, to=1400, by=400))
p <- p + coord_cartesian(xlim=c(22, 61), ylim=c(200, 1400))
return(p)
}
d_est <- data.frame.quantile.mcmc(x=X_new, y_mcmc=y_base_mcmc)
p <- ggplot.5quantile(data=d_est)
p <- p + geom_point(data=Salary, aes(x=X, y=Y), shape=1, size=3)
p <- customize.ggplot.axis(p)
# ggsave(file='output/fig4-8-left.png', plot=p, dpi=300, w=4, h=3)
p
d_est <- data.frame.quantile.mcmc(x=X_new, y_mcmc=y_mcmc)
p <- ggplot.5quantile(data=d_est)
p <- p + geom_point(data=Salary, aes(x=X, y=Y), shape=1, size=3)
p <- customize.ggplot.axis(p)
p
# ggsave(file='output/fig4-8-right.png', plot=p, dpi=300, w=4, h=3)
set.seed(123)
N1 <- 30
N2 <- 20
Y1 <- rnorm(n=N1, mean=0, sd=5)
Y2 <- rnorm(n=N2, mean=1, sd=4)
d1 <- data.frame(group=1, Y=Y1)
d2 <- data.frame(group=2, Y=Y2)
d <- rbind(d1, d2)
d$group <- as.factor(d$group)
p <- ggplot(data=d, aes(x=group, y=Y, group=group, col=group))
p <- p + geom_boxplot(outlier.size=0)
p <- p + geom_point(position=position_jitter(w=0.4, h=0), size=2)
p
#ggsave(file='fig-ex1.png', plot=p, dpi=300, w=4, h=3)
library(rstan)
data <- list(N1=N1, N2=N2, Y1=Y1, Y2=Y2)
exe13 <- stan_model(file = "stanfiles/ex3.stan")
fit <- sampling(exe13, data=data, seed=1234)
fit
library(rstan)
data <- list(N1=N1, N2=N2, Y1=Y1, Y2=Y2)
exe15 <- stan_model(file = "stanfiles/ex5.stan")
fit <- sampling(exe15, data=data, seed=1234)
fit
ms <- extract(fit)
ms <- rstan::extract(fit)
library(rstan)
data <- list(N1=N1, N2=N2, Y1=Y1, Y2=Y2)
exe15 <- stan_model(file = "stanfiles/ex5.stan")
fit <- sampling(exe15, data=data, seed=1234)
fit
ms <- rstan::extract(fit)
prob <- mean(ms$mu1 < ms$mu2)  #=> 0.93725
prob
blogdown::serve_site()
servr::daemon_stop(2)
blogdown::serve_site()
blogdown::serve_site()
install.packages(c("bayestestR", "broom", "ca", "callr", "clubSandwich", "dplyr", "effectsize", "emmeans", "epiR", "etm", "fracdiff", "gap", "ggeffects", "gh", "insight", "jsonlite", "lpSolve", "magick", "pkgmaker", "prettyunits", "raster", "RcppArmadillo", "repr", "RgoogleMaps", "rlang", "rngtools", "sf", "sjlabelled", "skimr", "tidybayes", "tidyr", "tidyselect", "timeSeries", "TSP", "vctrs", "yaml"))
servr::daemon_stop(3)
servr::daemon_stop(2)
servr::daemon_stop(1)
blogdown::serve_site()
blogdown:::new_post_addin()
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown::serve_site()
ermoji:::ermoji_gadget()
ermoji:::ermoji_gadget()
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
install.packages(c("dendextend", "foreach", "forecast", "parameters", "processx", "RcppArmadillo", "sfsmisc", "trimcluster"))
blogdown:::new_post_addin()
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown::serve_site()
blogdown:::new_post_addin()
install.packages(c("ade4", "ggpubr", "learnr", "MCMCpack", "processx", "ps", "qvcalc", "R.methodsS3", "RcppArmadillo", "remotes", "rgl"))
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
install.packages(c("gplots", "manipulateWidget", "mvtnorm"))
blogdown::serve_site()
install.packages(c("bridgesampling", "effectsize", "nnet", "tinytex", "uuid"))
blogdown::serve_site()
install.packages(c("cli", "dendextend", "epiR", "naniar", "sciplot", "sp"))
install.packages(c("broom", "FactoMineR", "gss", "nloptr"))
install.packages("nloptr")
blogdown::serve_site()
blogdown::serve_site()
servr::daemon_stop(1)
blogdown::serve_site()
servr::daemon_stop(1)
blogdown::serve_site()
servr::daemon_stop(2)
install.packages(c("dbplyr", "emmeans", "raster"))
blogdown:::new_post_addin()
install.packages(c("bayestestR", "broom", "DHARMa", "etm", "ggeffects", "insight", "spaMM", "svUnit", "tibble", "withr"))
10015/48
install.packages("rex")
install.packages("countrycode")
install.packages("xml2")
install.packages(c("arm", "labelled", "R2jags", "RcppArmadillo"))
install.packages("RcppArmadillo")
blogdown::serve_site()
servr::daemon_stop(2)
servr::daemon_stop(3)
servr::daemon_stop(4)
servr::daemon_stop(1)
blogdown::serve_site()
servr::daemon_stop(1)
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown::serve_site()
blogdown:::new_post_addin()
blogdown:::insert_image_addin()
servr::daemon_stop(2)
blogdown::serve_site()
servr::daemon_stop(3)
blogdown::serve_site()
servr::daemon_stop(4)
blogdown::serve_site()
servr::daemon_stop(1)
blogdown::serve_site()
servr::daemon_stop(2)
blogdown::serve_site()
servr::daemon_stop(3)
blogdown:::new_post_addin()
blogdown::serve_site()
servr::daemon_stop(4)
blogdown::serve_site()
servr::daemon_stop(5)
blogdown::update_hugo()
blogdown::hugo_version()
blogdown:::find_hugo()
blogdown::hugo_version()
blogdown::install_hugo(force = TRUE)
blogdown::hugo_version()
blogdown::serve_site()
blogdown::serve_site()
devtools::install_github('rstudio/blogdown')
blogdown::serve_site()
update.packages(ask = FALSE, checkBuilt = TRUE)
servr::daemon_stop(5)
servr::daemon_stop(6)
servr::daemon_stop(1)
servr::daemon_stop(2)
blogdown::build_site()
Salary <- read.table("https://raw.githubusercontent.com/winterwang/RStanBook/master/chap04/input/data-salary.txt",
sep = ",", header = T)
library(ggplot2)
ggplot(Salary, aes(x = X, y = Y)) +
geom_point(shape = 1, size = 4)  + theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
axis.line = element_line(colour = "bisque4",
size = 0.2, linetype = "solid"),
axis.ticks = element_line(size = 0.7),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16, colour = "gray0"),
panel.background = element_rect(fill = "gray98")) +
scale_y_continuous(limits = c(200, 1400), breaks = c(200, 600, 1000, 1400))
res_lm <- lm(Y ~ X, data = Salary)
summary(res_lm)
# 用這個線性回歸模型來對上面模型中的參數作出預測：
X_new <- data.frame(X=23:60)
conf_95 <- predict(res_lm, X_new, interval = "confidence", level = 0.95)
pred_95 <- predict(res_lm, X_new, interval = "prediction", level = 0.95)
temp_var <- predict(res_lm, interval="prediction")
new_df <- cbind(Salary, temp_var)
ggplot(new_df, aes(x = X, y = Y)) +
geom_point(shape = 1, size = 4)  + theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
axis.line = element_line(colour = "bisque4",
size = 0.2, linetype = "solid"),
axis.ticks = element_line(size = 0.7),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16, colour = "gray0"),
panel.background = element_rect(fill = "gray98")) +
geom_smooth(method = lm, se=TRUE, size = 0.3)+
scale_y_continuous(limits = c(200, 1400), breaks = c(200, 600, 1000, 1400)) +
geom_line(aes(y=lwr), color = "red", linetype = "dashed")+
geom_line(aes(y=upr), color = "red", linetype = "dashed")
knitr::include_graphics("/img/traceplot-model4-5.png")
knitr::include_graphics("img/traceplot-model4-5.png")
getwd()
knitr::include_graphics("../../img/traceplot-model4-5.png")
knitr::include_graphics("../../img/traceplot-model4-5.png")
knitr::include_graphics("../../../img/traceplot-model4-5.png")
knitr::include_graphics("../../static/img/traceplot-model4-5.png")
blogdown::serve_site()
servr::daemon_stop(3)
blogdown::serve_site()
servr::daemon_stop(4)
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
servr::daemon_stop(5)
blogdown::build_site()
blogdown::serve_site()
servr::daemon_stop(6)
blogdown::serve_site()
blogdown::stop_server()
blogdown:::new_post_addin()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
install.packages(c("sjmisc", "StanHeaders", "survminer"))
blogdown::serve_site()
servr::daemon_stop(1)
blogdown::serve_site()
blogdown::serve_site()
servr::daemon_stop(1)
install.packages(c("ape", "mangoTraining", "rms", "rsample", "showtextdb", "SQUAREM"))
blogdown:::new_post_addin()
blogdown::serve_site()
servr::daemon_stop()
blogdown::serve_site()
servr::daemon_stop()
blogdown:::new_post_addin()
blogdown::serve_site()
servr::daemon_stop()
.libPaths()
blogdown::serve_site()
blogdown:::new_post_addin()
servr::daemon_stop()
blogdown::serve_site()
servr::daemon_stop(1)
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
