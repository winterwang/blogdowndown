---
title: 你買的彩票中獎概率到底有多少？
author: ''
date: '2017-10-11'
slug: probability3
categories:
  - statistics
  - study abroad
tags:
  - basic mathematics
  - learning notes
  - Medical Statistics
  - LSHTM
summary: "簡單的離散分佈：二項分佈，泊松分佈"
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="二項分佈的概念-binomial-distribution" class="section level3">
<h3>二項分佈的概念 Binomial distribution</h3>
<p>二項分佈在醫學研究中至關重要，一組二項分佈的數據，指的通常是 <span class="math inline">\(n\)</span> 次相互獨立的<a href="https://winterwang.github.io/post/probability2-4/">成功率爲 <span class="math inline">\(\pi\)</span> 的伯努利實驗</a> (<span class="math inline">\(n\)</span> independent Bernoulli trials) 中成功的次數。</p>
<p>當 <span class="math inline">\(X\)</span> 服從二項分佈，記爲 <span class="math inline">\(X \sim binomial(n, \pi)\)</span> 或<span class="math inline">\(X \sim bin(n, \pi)\)</span>。它的(第 <span class="math inline">\(x\)</span> 次實驗的)概率被定義爲：</p>
<p><span class="math display">\[\begin{align}
P(X=x) &amp;= ^nC_x\pi^x(1-\pi)^{n-x} \\
       &amp;= \binom{n}{x}\pi^x(1-\pi)^{n-x} \\
       &amp; for\;\; x = 0,1,2,\dots,n
\end{align}\]</span></p>
<div id="二項分佈的期望和方差" class="section level4">
<h4>二項分佈的期望和方差</h4>
<ul>
<li>期望 <span class="math inline">\(E(X)\)</span>
<ul>
<li>若 <span class="math inline">\(X \sim bin(n,\pi)\)</span>，那麼 <span class="math inline">\(X\)</span> 就是這一系列獨立伯努利實驗中成功的次數。</li>
<li>用 <span class="math inline">\(X_i, i =1,\dots, n\)</span> 標記每個相互獨立的伯努利實驗。</li>
<li>那麼我們可以知道 <span class="math inline">\(X=\sum_{i=1}^nX_i\)</span>。
<span class="math display">\[\begin{align} E(X) &amp;= E(\sum_{i=1}^nX_i)\\
                   &amp;= E(X_1+X_2+\cdots+X_n) \\
                   &amp;= E(X_1)+E(X_2)+\cdots+E(X_n)\\
                   &amp;= \sum_{i=1}^nE(X_i)\\
                   &amp;= \sum_{i=1}^n\pi \\
                   &amp;= n\pi
\end{align}\]</span></li>
</ul></li>
<li>方差 <span class="math inline">\(Var(X)\)</span>
<span class="math display">\[\begin{align}
Var(X) &amp;= Var(\sum_{i=1}^nX_i) \\
      &amp;= Var(X_i+X_2+\cdots+X_n) \\
      &amp;= Var(X_i)+Var(X_2)+\cdots+Var(X_n) \\
      &amp;= \sum_{i=1}^nVar(X_i) \\
      &amp;= n\pi(1-\pi) \\
\end{align}\]</span></li>
</ul>
</div>
</div>
<div id="超幾何分佈-hypergeometric-distribution" class="section level3">
<h3>超幾何分佈 hypergeometric distribution</h3>
<p>假設我們從總人數爲 <span class="math inline">\(N\)</span> 的人羣中，採集一個樣本 <span class="math inline">\(n\)</span>。假如已知在總體人羣中(<span class="math inline">\(N\)</span>)有 <span class="math inline">\(M\)</span> 人患有某種疾病。請問採集的樣本 <span class="math inline">\(X=n\)</span> 中患有這種疾病的人，服從怎樣的分佈？</p>
<ul>
<li>從人羣(<span class="math inline">\(N\)</span>)中取出樣本(<span class="math inline">\(n\)</span>)，有 <span class="math inline">\(^NC_n\)</span> 種方法。</li>
<li>從患病人羣(<span class="math inline">\(M\)</span>)中取出患有該病的人(<span class="math inline">\(x\)</span>)有 <span class="math inline">\(^MC_x\)</span> 種方法。</li>
<li>樣本中不患病的人(<span class="math inline">\(n-x\)</span>)被採樣的方法有 <span class="math inline">\(^{N-M}C_{n-x}\)</span> 種。</li>
<li>採集一次 <span class="math inline">\(n\)</span> 人作爲樣本的概率都一樣。因此：</li>
</ul>
<p><span class="math display">\[P(X=x)=\frac{\binom{M}{x}\binom{N-M}{n-x}}{\binom{N}{n}}\]</span></p>
</div>
<div id="樂透中獎概率問題" class="section level3">
<h3>樂透中獎概率問題：</h3>
<ul>
<li>從數字 <span class="math inline">\(1\sim59\)</span> 中選取 <span class="math inline">\(6\)</span> 個任意號碼</li>
<li>開獎時從 <span class="math inline">\(59\)</span> 個號碼球中隨機抽取 <span class="math inline">\(6\)</span> 個</li>
<li>如果六個號碼全部猜中(不分順序)，你可以成爲百萬富翁。請問一次猜中全部 <span class="math inline">\(6\)</span> 個號碼的概率是多少？</li>
</ul>
<p>從 <span class="math inline">\(59\)</span> 個號碼中隨機取出任意 <span class="math inline">\(6\)</span> 個號碼的方法有 <span class="math inline">\(^{59}C_6\)</span> 種。
<span class="math display">\[^{59}C_6=\frac{59!}{6!(59-6)!}=45,057,474\]</span></p>
<p>每次選取六個號碼做爲一組的可能性相同，所以，你買了一組樂透號碼，能中獎的概率就是 <span class="math inline">\(1/45,057,474 = 0.00000002219\)</span>。你還會再去買彩票麼？</p>
<div id="如果我只想中其中的-3-個號碼概率有多大" class="section level4">
<h4>如果我只想中其中的 <span class="math inline">\(3\)</span> 個號碼，概率有多大？</h4>
<p>用超幾何分佈的概率公式：</p>
<p><span class="math display">\[\begin{align}
P(X=3) &amp;= \frac{^6C_3\times ^{53}C_3}{^{59}C_6} \\
       &amp;= 0.010
\end{align}\]</span></p>
<p>你有 <span class="math inline">\(1\%\)</span> 的可能中獎。換句話說，如果中三個以上的數字算中獎的話，你買的彩票中獎的概率低於 <span class="math inline">\(1\%\)</span>。是不是覺得下次送錢給博彩公司的時候還不如跟我一起喝一杯咖啡划算？</p>
</div>
</div>
<div id="泊松分佈-poisson-distribution" class="section level3">
<h3>泊松分佈 Poisson Distribution</h3>
<ul>
<li>當一個事件，在一段時間 (<span class="math inline">\(T\)</span>) 中可能發生的次數是 <span class="math inline">\(\lambda\)</span> 。那麼我們可以認爲，經過時間 <span class="math inline">\(T\)</span>，該時間發生的期望次數是 <span class="math inline">\(E(X)=\lambda T\)</span>。</li>
<li>利用微分思想，將這段時間 <span class="math inline">\(T\)</span> 等分成 <span class="math inline">\(n\)</span> 個時間段，當 <span class="math inline">\(n\rightarrow\infty\)</span> 直到每個微小的時間段內最多發生一次該事件。</li>
</ul>
<p>那麼</p>
<ul>
<li>每個微小的時間段，可以視爲是一個伯努利實驗（有事件發生或者沒有）</li>
<li>那麼這整段時間 <span class="math inline">\(T\)</span> 內發生的事件可以視爲是一個二項分佈實驗。</li>
</ul>
<p>令 <span class="math inline">\(X=\)</span> 一次事件發生時所經過的所有時間段。</p>
<ul>
<li><span class="math inline">\(X \sim Bin(n, \pi)\)</span>，其中 <span class="math inline">\(n\rightarrow\infty\)</span>，<span class="math inline">\(n\)</span> 爲時間段。</li>
<li>在每個分割好的時間段內，事件發生的概率都是：<span class="math inline">\(\pi=\frac{\lambda T}{n}\)</span></li>
<li>期望 <span class="math inline">\(\mu=\lambda T \Rightarrow \pi=\mu/n\)</span></li>
<li>所以 <span class="math inline">\(X\)</span> 的概率方程就是：
<span class="math display">\[\begin{align}
P(X=x) &amp;= \binom{n}{x}\pi^x(1-\pi)^{n-x} \\
     &amp;= \binom{n}{x}(\frac{\mu}{n})^x(1-\frac{\mu}{n})^{n-x} \\
     &amp;= \frac{n!}{x!(n-x)!}(\frac{\mu}{n})^x(1-\frac{\mu}{n})^{n-x} \\
     &amp;=\frac{n!}{n^x(n-x)!}\frac{\mu^x}{x!}(1-\frac{\mu}{n})^{n-x}\\
當 n\rightarrow\infty   &amp;\; x \ll n (x遠小於n) 時\\
\frac{n!}{n^x(n-x)!} &amp;=\frac{n(n-1)\dots(n-x+1)}{n^x} \rightarrow 1\\
(1-\frac{\mu}{n})^{n-x} &amp;\approx  (1-\frac{\mu}{n})^n \rightarrow e^{-\mu}\\
所以 我們可&amp;以得到泊松分佈的概率公式：   \\
P(X=x) &amp;\rightarrow \frac{\mu^x}{x!}e^{-\mu}
\end{align}\]</span></li>
</ul>
<p>當數據服從泊松分佈時，記爲 <span class="math inline">\(X\sim Poisson(\mu=\lambda T)\;\; or\;\; X\sim Poi(\mu)\)</span></p>
</div>
<div id="證明泊松分佈的參數特徵" class="section level3">
<h3>證明泊松分佈的參數特徵：</h3>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E(X)=\mu\)</span></li>
</ol>
<p><span class="math display">\[\begin{align}
E(X)  &amp;=  \sum_{x=0}^\infty xP(X=x) \\
      &amp;=  \sum_{x=0}^\infty x\frac{\mu^x}{x!}e^{-\mu} \\
      &amp;= 0+ \sum_{x=1}^\infty x\frac{\mu^x}{x!}e^{-\mu} \\
      &amp;=  \sum_{x=1}^\infty \frac{\mu^x}{(x-1)!}e^{-\mu} \\
      &amp;=  \mu\sum_{x=1}^\infty \frac{\mu^{x-1}}{(x-1)!}e^{-\mu} \\
這個時候我們用i&amp;=x-1 替換掉所有的 x \\
      &amp;=  \mu\sum_{i=0}^\infty \frac{\mu^{i}}{i!}e^{-\mu} \\
注意到右半部分 &amp;\sum_{i=0}^\infty \frac{\mu^{i}}{i!}e^{-\mu}=1 是一個\\泊松分佈的所有&amp;概率和 \\
      &amp;= \mu
\end{align}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><span class="math inline">\(Var(x)=\mu\)</span>
爲了找到 <span class="math inline">\(Var(X)\)</span>，我們用公式 <span class="math inline">\(Var(X)=E(X^2)-E(X)^2\)</span></li>
</ol>
<p>我們需要找到 <span class="math inline">\(E(X^2)\)</span></p>
<p><span class="math display">\[\begin{align}
E(X^2) &amp;= \sum_{x=0}^\infty x^2\frac{\mu^x}{x!}e^{-\mu} \\
       &amp;= \mu \sum_{x=1}^\infty x\frac{\mu^{x-1}}{(x-1)!}e^{-\mu} \\
這個時候我們用i&amp;=x-1 替換掉所有的 x \\
       &amp;= \mu \sum_{i=0}^\infty (i+1)\frac{\mu^{i}}{i!}e^{-\mu} \\
       &amp;= \mu(\sum_{i=0}^\infty i\frac{\mu^i}{i!}e^{-\mu} + \sum_{i=0}^\infty \frac{\mu^i}{i!}e^{-\mu}) \\
       &amp;= \mu(E(X)+1) \\
       &amp;= \mu^2+\mu \\
因此，代入上面&amp;提到的方差公式： \\
Var(X) &amp;= E(X^2) - E(X)^2 \\
       &amp;= \mu^2 + \mu -\mu^2 \\
       &amp;= \mu
\end{align}\]</span></p>
</div>
